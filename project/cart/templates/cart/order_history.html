<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    {% include "cdn.html" %}
    <title>Order History</title>
    <style>
      /* Enhanced responsive styles */
      @media (max-width: 767.98px) {
        /* Existing table responsive styles */
        .table-responsive {
          border: 0;
        }

        .table-responsive table {
          border-collapse: collapse;
        }

        .table-responsive thead {
          border: none;
          clip: rect(0 0 0 0);
          height: 1px;
          margin: -1px;
          overflow: hidden;
          padding: 0;
          position: absolute;
          width: 1px;
        }

        .table-responsive tr {
          border-bottom: 1px solid #ddd;
          display: block;
          margin-bottom: 0.5rem;
        }

        .table-responsive td {
          border: none;
          display: block;
          text-align: right;
          padding: 0.5rem;
        }

        .table-responsive td:before {
          content: attr(data-label);
          float: left;
          font-weight: bold;
        }

        .table-responsive td:last-child {
          border-bottom: 0;
        }

        /* Additional mobile optimizations */
        .card-header h3 {
          font-size: 1.1rem;
        }

        .container {
          padding-left: 1rem;
          padding-right: 1rem;
        }
      }

      /* Tablet styles */
      @media (min-width: 768px) and (max-width: 991.98px) {
        .container {
          max-width: 90%;
        }
      }

      /* Improve readability on all devices */
      .card {
        transition: box-shadow 0.3s ease;
      }

      .card:hover {
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
      }

      /* Better spacing for order total */
      .order-total {
        border-top: 2px solid #dee2e6;
        padding-top: 1rem;
        margin-top: 1rem;
      }
    </style>
  </head>
  <body>
    {% include "header.html" %}

    <div class="container py-3 py-md-4">
      <div class="row">
        <div class="col-12">
          <h2 class="mb-3 mb-md-4">My Orders</h2>

          {% if orders %}
          <div class="row">
            {% for order in orders %}
            <div class="col-12 mb-3 mb-md-4">
              <div class="card shadow-sm">
                <div
                  class="card-header bg-light d-flex justify-content-between align-items-center flex-wrap gap-2"
                >
                  <h3 class="h5 mb-0">Order #{{ order.id }}</h3>
                  <span
                    class="badge bg-{% if order.status == 'Delivered' %}success{% elif order.status == 'Processing' %}warning{% elif order.status == 'Shipped' %}info{% else %}secondary{% endif %}"
                  >
                    {{ order.status }}
                  </span>
                </div>

                <div class="card-body">
                  <div class="mb-3">
                    <p class="text-muted mb-0 small">
                      <i class="bi bi-calendar3"></i>
                      Placed on: {{ order.created_at|date:"F j, Y" }}
                    </p>
                  </div>

                  <h4 class="h6 mt-3 mb-2">Order Items</h4>
                  <div class="table-responsive">
                    <table class="table table-sm">
                      <thead class="table-light">
                        <tr>
                          <th>Product</th>
                          <th class="text-center">Quantity</th>
                          <th class="text-end">Price</th>
                        </tr>
                      </thead>
                      <tbody>
                        {% for item in order.items.all %}
                        <tr>
                          <td data-label="Product">{{ item.product.name }}</td>
                          <td data-label="Quantity" class="text-center">
                            {{ item.quantity }}
                          </td>
                          <td data-label="Price" class="text-end">
                            ${{ item.get_total }}
                          </td>
                        </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                    <div class="order-total">
                      <p class="fw-bold mb-0 text-end">
                        Total (including Shipping $10):
                        <span class="text-primary"
                          >${{ order.total_price }}</span
                        >
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
          {% else %}
          <div class="card shadow-sm">
            <div class="card-body text-center py-4 py-md-5">
              <div class="mb-3">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="48"
                  height="48"
                  fill="currentColor"
                  class="bi bi-bag text-muted"
                  viewBox="0 0 16 16"
                >
                  <path
                    d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1zm3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4h-3.5zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5z"
                  />
                </svg>
              </div>
              <h3 class="h5 mb-3">No Orders Yet</h3>
              <p class="text-muted mb-3">
                You haven't placed any orders with us yet.
              </p>
              <a href="/" class="btn btn-primary">Start Shopping</a>
            </div>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </body>
</html>
